# 政策効果予測AI機能実装

## 概要
機械学習・統計モデルを活用し、政策実施前に効果を予測するAI機能を実装する。人口動態、経済効果、住みやすさスコア変化を定量的に予測し、政策立案の科学的根拠を提供する。

## 目的
- データ駆動型政策立案支援
- 政策効果の事前定量評価
- 限られた予算・資源の効率的配分支援
- 政策リスクの早期発見・軽減
- 長期的な地域発展戦略策定支援

## 主要機能

### 1. 人口動態予測モデル
- **人口推移予測**: 年齢階層別人口の時系列予測
- **転入・転出予測**: 政策による人口流動変化予測
- **出生率・死亡率影響**: 政策による自然増減への影響
- **シナリオ分析**: 複数政策組み合わせによる効果比較

### 2. 経済効果予測モデル
- **GDP・所得への影響**: 政策による経済波及効果
- **雇用創出効果**: 新規雇用・失業率への影響予測
- **税収変化予測**: 政策実施による税収増減の予測
- **産業別影響分析**: セクター別の経済効果測定

### 3. 住みやすさスコア予測
- **総合スコア予測**: 政策による住みやすさ指標変化
- **分野別影響**: 教育・医療・交通等の個別効果
- **地域間格差**: 政策による地域格差の変化予測
- **住民満足度**: アンケート結果に基づく満足度予測

### 4. 政策最適化支援
- **予算配分最適化**: 制約条件下での最適な資源配分
- **政策組み合わせ最適化**: 複数政策の相乗効果最大化
- **実施タイミング最適化**: 効果的な政策実施時期の提案
- **リスク評価**: 予測の不確実性・信頼区間の提示

## 技術要件

### 機械学習・統計分析
- **Python 3.11+**: 機械学習開発基盤
- **scikit-learn**: 基本的な機械学習アルゴリズム
- **statsmodels**: 統計的時系列分析
- **pandas/numpy**: データ処理・数値計算
- **XGBoost/LightGBM**: 高精度予測モデル（勾配ブースティング）

### 深層学習（オプション）
- **TensorFlow/PyTorch**: ニューラルネットワーク
- **LSTM/Transformer**: 時系列深層学習
- **AutoML**: 自動機械学習（Google AutoML、H2O.ai等）

### 統計・最適化
- **scipy**: 科学計算・最適化
- **cvxpy**: 凸最適化
- **pymc**: ベイズ統計・不確実性定量化
- **optuna**: ハイパーパラメータ最適化

## 実装内容

### Phase 1: データ基盤・前処理（4週間）

1. **データ収集・統合**
   - 政府統計データ（e-Stat API連携）
   - 鳥取県統計データ
   - 他県類似政策データ（成功・失敗事例）
   - 経済・社会指標の時系列データ
   
   ```python
   # data/collectors/estat_collector.py
   import requests
   import pandas as pd

   class EstatCollector:
       def __init__(self, api_key):
           self.api_key = api_key
           self.base_url = "https://api.e-stat.go.jp/rest/3.0/app/json"
       
       def get_population_data(self, prefecture_code, years):
           # 人口データ取得・変換
           pass
   ```

2. **データクリーニング・特徴エンジニアリング**
   - 欠損値処理・異常値検出
   - 時系列データの正規化・スケーリング
   - 特徴量生成（移動平均、季節性、トレンド）
   - 外部変数（気候、経済指標等）の統合

3. **データセット構築**
   - 訓練・検証・テストデータ分割
   - 政策効果ラベルの定義・作成
   - クロスバリデーション戦略

### Phase 2: 人口動態予測モデル（3週間）

1. **基本統計モデル**
   - ARIMA: 自己回帰統合移動平均モデル
   - VAR: ベクトル自己回帰モデル
   - State Space: 状態空間モデル
   
   ```python
   # models/population_forecast.py
   from statsmodels.tsa.arima.model import ARIMA
   from sklearn.metrics import mean_absolute_error

   class PopulationPredictor:
       def __init__(self):
           self.models = {}
       
       def fit_arima(self, data, order=(1,1,1)):
           model = ARIMA(data, order=order)
           fitted = model.fit()
           return fitted
       
       def predict_population(self, policy_scenario, years_ahead=10):
           # 政策シナリオに基づく人口予測
           pass
   ```

2. **機械学習モデル**
   - XGBoost: 勾配ブースティング
   - Random Forest: アンサンブル学習
   - Support Vector Regression: サポートベクター回帰

3. **政策効果組み込み**
   - 政策ダミー変数
   - 政策強度・継続期間の定量化
   - 他地域政策効果の transfer learning

### Phase 3: 経済効果予測モデル（3週間）

1. **マクロ経済モデル**
   - 産業連関分析: 経済波及効果計算
   - CGE(Computable General Equilibrium): 一般均衡モデル
   - 時系列計量経済学: 経済指標予測

2. **雇用・所得予測**
   - 雇用弾性値に基づく雇用創出効果
   - 所得関数モデル
   - 税収予測モデル

3. **機械学習統合**
   - 経済指標の非線形関係学習
   - 政策と経済指標の相互作用モデリング
   - アンサンブル予測

### Phase 4: 住みやすさ予測・最適化（4週間）

1. **住みやすさスコア予測**
   - 多変量回帰: 複数指標の統合モデル
   - 階層ベイズモデル: 地域間差異の適切なモデリング
   - 主成分分析: 次元削減・主要因子抽出

2. **政策最適化アルゴリズム**
   - 線形計画法: 予算制約下の最適配分
   - 遺伝アルゴリズム: 複雑な制約条件での最適化
   - ベイズ最適化: 政策パラメータの効率的探索
   
   ```python
   # models/policy_optimizer.py
   import cvxpy as cp
   from scipy.optimize import differential_evolution

   class PolicyOptimizer:
       def __init__(self, models, constraints):
           self.models = models
           self.constraints = constraints
       
       def optimize_budget_allocation(self, total_budget, policies):
           # 予算配分最適化
           x = cp.Variable(len(policies))
           objective = cp.Maximize(self.calculate_total_effect(x))
           constraints = [
               cp.sum(x) <= total_budget,
               x >= 0
           ]
           problem = cp.Problem(objective, constraints)
           problem.solve()
           return x.value
   ```

3. **不確実性・リスク評価**
   - モンテカルロシミュレーション
   - 信頼区間・予測区間の計算
   - 感度分析: パラメータ変動による効果の変化

### Phase 5: API・UI統合（2週間）

1. **予測APIエンドポイント**
   - `/api/predict/population`: 人口予測API
   - `/api/predict/economy`: 経済効果予測API
   - `/api/predict/livability`: 住みやすさ予測API
   - `/api/optimize/policy`: 政策最適化API

2. **フロントエンド統合**
   - 予測結果可視化（Chart.js/D3.js）
   - シナリオ設定UI
   - 信頼区間・不確実性の表示
   - 最適化結果のインタラクティブ表示

## ファイル構造
```
backend/
├── ml_models/                    # 機械学習モデル
│   ├── __init__.py
│   ├── population_forecast.py    # 人口予測モデル
│   ├── economic_impact.py        # 経済効果予測
│   ├── livability_score.py       # 住みやすさ予測
│   └── policy_optimizer.py       # 政策最適化
├── data/
│   ├── collectors/               # データ収集
│   ├── preprocessors/            # 前処理
│   ├── raw/                      # 生データ
│   ├── processed/                # 処理済みデータ
│   └── models/                   # 訓練済みモデル
├── api/
│   ├── prediction.py            # 予測API
│   └── optimization.py          # 最適化API
├── utils/
│   ├── model_evaluation.py      # モデル評価
│   ├── validation.py            # 予測検証
│   └── visualization.py         # 結果可視化
└── notebooks/                   # 研究・開発用notebook
    ├── exploration.ipynb        # データ探索
    ├── model_development.ipynb  # モデル開発
    └── evaluation.ipynb         # 評価・検証
```

## モデル評価指標
- **予測精度**: MAE (Mean Absolute Error) < 5%
- **人口予測**: 5年後人口の予測誤差 < 3%
- **経済効果**: GDP影響の予測誤差 < 10%
- **住みやすさ**: スコア予測の相関係数 > 0.8
- **最適化性能**: 制約充足率 100%、収束時間 < 30秒

## データソース・連携
- **e-Stat**: 政府統計データAPI
- **鳥取県統計**: 県内詳細データ
- **RESAS**: 地域経済分析システム
- **内閣府経済社会総合研究所**: マクロ経済指標
- **他県政策データ**: 類似政策の成功・失敗事例

## 成功指標
- **予測モデル精度**: 検証データでMAE < 5%達成
- **政策立案活用**: 月10件以上の予測機能利用
- **意思決定支援**: 予算配分決定での活用事例月5件以上
- **ユーザー満足度**: 政策立案者満足度4.5以上（5段階）

## リスク・対策
- **データ品質**: 統計データの欠損・遅延 → 複数ソース活用・補完手法
- **モデル精度**: 予測精度不足 → アンサンブル学習・継続的モデル改善
- **計算性能**: 大規模最適化の計算時間 → 分散処理・近似アルゴリズム
- **解釈性**: AIブラックボックス問題 → LIME/SHAP等の説明可能AI導入

## 完了条件
- [ ] 人口動態予測モデル実装・精度検証完了
- [ ] 経済効果予測モデル実装・検証完了
- [ ] 住みやすさスコア予測機能実装
- [ ] 政策最適化アルゴリズム実装
- [ ] 予測APIエンドポイント実装
- [ ] フロントエンドUI統合完了
- [ ] モデル精度目標達成（MAE < 5%）
- [ ] 実政策データでの検証・校正完了
- [ ] 不確実性評価・信頼区間計算機能実装
- [ ] ドキュメント・利用ガイド作成

## 工数見積もり
**合計: 16週間**
- Phase 1 (データ基盤): 4週間
- Phase 2 (人口予測): 3週間
- Phase 3 (経済効果): 3週間
- Phase 4 (住みやすさ・最適化): 4週間
- Phase 5 (API・UI統合): 2週間

## 次のステップ
1. データ収集・統合システム構築
2. 基本統計モデル（ARIMA）実装・検証
3. 政策効果データの定義・ラベル化
4. XGBoost人口予測モデル開発
5. APIエンドポイント設計・実装